<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>../bb/lib/widget/slider.js - ose-bundle</title>
  <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
  <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
  <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
  <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.4/zepto.min.js"></script>
</head>
<body class="yui3-skin-sam">

  <div id="doc">
    <div class="yui3-g">

      <div id="sidebar" class="yui3-u">
        <a href="../index.html"><h2>OSE documentation</h2></a>

        <div class="sidebox">
          <div class="hd">
            <h2 class="no-toc">Type to filter sidebar:</h2>
          </div>
          <div class="bd">
            <input id="filter-input" />
          </div>
        </div>

        







<div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All packages and components</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/bb.html">bb</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/bb.html#bb.box">bb.box</a></li> -->
                            <li><a href="../modules/bb.box.html">bb.box</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.dialog">bb.dialog</a></li> -->
                            <li><a href="../modules/bb.dialog.html">bb.dialog</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.pagelet">bb.pagelet</a></li> -->
                            <li><a href="../modules/bb.pagelet.html">bb.pagelet</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.widget">bb.widget</a></li> -->
                            <li><a href="../modules/bb.widget.html">bb.widget</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.stateObj">bb.stateObj</a></li> -->
                            <li><a href="../modules/bb.stateObj.html">bb.stateObj</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/boards.html">boards</a>
                
                </li>
            
                <li><a href="../modules/bundle.html">bundle</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/bundle.html#bundle.media">bundle.media</a></li> -->
                            <li><a href="../modules/bundle.media.html">bundle.media</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/control.html">control</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/control.html#control.distributor">control.distributor</a></li> -->
                            <li><a href="../modules/control.distributor.html">control.distributor</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.pin">control.pin</a></li> -->
                            <li><a href="../modules/control.pin.html">control.pin</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.room">control.room</a></li> -->
                            <li><a href="../modules/control.room.html">control.room</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.remote">control.remote</a></li> -->
                            <li><a href="../modules/control.remote.html">control.remote</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/dvb.html">dvb</a>
                
                </li>
            
                <li><a href="../modules/fs.html">fs</a>
                
                </li>
            
                <li><a href="../modules/icecast.html">icecast</a>
                
                </li>
            
                <li><a href="../modules/lirc.html">lirc</a>
                
                </li>
            
                <li><a href="../modules/media.html">media</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/media.html#media.history">media.history</a></li> -->
                            <li><a href="../modules/media.history.html">media.history</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.player">media.player</a></li> -->
                            <li><a href="../modules/media.player.html">media.player</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.stream">media.stream</a></li> -->
                            <li><a href="../modules/media.stream.html">media.stream</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.source">media.source</a></li> -->
                            <li><a href="../modules/media.source.html">media.source</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/ose.html">ose</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/ose.html#ose.data">ose.data</a></li> -->
                            <li><a href="../modules/ose.data.html">ose.data</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.http">ose.http</a></li> -->
                            <li><a href="../modules/ose.http.html">ose.http</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.peer">ose.peer</a></li> -->
                            <li><a href="../modules/ose.peer.html">ose.peer</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.link">ose.link</a></li> -->
                            <li><a href="../modules/ose.link.html">ose.link</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.logger">ose.logger</a></li> -->
                            <li><a href="../modules/ose.logger.html">ose.logger</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.plugin">ose.plugin</a></li> -->
                            <li><a href="../modules/ose.plugin.html">ose.plugin</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.wrap">ose.wrap</a></li> -->
                            <li><a href="../modules/ose.wrap.html">ose.wrap</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/pa.html">pa</a>
                
                </li>
            
                <li><a href="../modules/rpi.html">rpi</a>
                
                </li>
            
                <li><a href="../modules/videolan.html">videolan</a>
                
                </li>
            
                <li><a href="../modules/xorg.html">xorg</a>
                
                </li>
            
                <li><a href="../modules/youtube.html">youtube</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/bb.content.html">bb.content</a></li>
            
                <li><a href="../classes/bb.lib.html">bb.lib</a></li>
            
                <li><a href="../classes/bb.lib.box.content.html">bb.lib.box.content</a></li>
            
                <li><a href="../classes/bb.lib.box.left.html">bb.lib.box.left</a></li>
            
                <li><a href="../classes/bb.lib.dialog.html">bb.lib.dialog</a></li>
            
                <li><a href="../classes/bb.lib.dialog.action.html">bb.lib.dialog.action</a></li>
            
                <li><a href="../classes/bb.lib.dialog.confirm.html">bb.lib.dialog.confirm</a></li>
            
                <li><a href="../classes/bb.lib.dialog.info.html">bb.lib.dialog.info</a></li>
            
                <li><a href="../classes/bb.lib.dialog.valueSelector.html">bb.lib.dialog.valueSelector</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.html">bb.lib.pagelet</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.dashboard.html">bb.lib.pagelet.dashboard</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.detail.html">bb.lib.pagelet.detail</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.entry.html">bb.lib.pagelet.entry</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.gesture.html">bb.lib.pagelet.gesture</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.list.html">bb.lib.pagelet.list</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.listItem.html">bb.lib.pagelet.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.html">bb.lib.widget</a></li>
            
                <li><a href="../classes/bb.lib.widget.button.html">bb.lib.widget.button</a></li>
            
                <li><a href="../classes/bb.lib.widget.checkbox.html">bb.lib.widget.checkbox</a></li>
            
                <li><a href="../classes/bb.lib.widget.list.html">bb.lib.widget.list</a></li>
            
                <li><a href="../classes/bb.lib.widget.listItem.html">bb.lib.widget.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.search.html">bb.lib.widget.search</a></li>
            
                <li><a href="../classes/bb.lib.widget.slider.html">bb.lib.widget.slider</a></li>
            
                <li><a href="../classes/bb.lib.widget.slideswitch.html">bb.lib.widget.slideswitch</a></li>
            
                <li><a href="../classes/bb.lib.widget.toolbar.html">bb.lib.widget.toolbar</a></li>
            
                <li><a href="../classes/boards.content.html">boards.content</a></li>
            
                <li><a href="../classes/boards.lib.html">boards.lib</a></li>
            
                <li><a href="../classes/bundle.doc.html">bundle.doc</a></li>
            
                <li><a href="../classes/bundle.example.media.html">bundle.example.media</a></li>
            
                <li><a href="../classes/bundle.examples.media.config.html">bundle.examples.media.config</a></li>
            
                <li><a href="../classes/bundle.Gruntfile.html">bundle.Gruntfile</a></li>
            
                <li><a href="../classes/control.content.html">control.content</a></li>
            
                <li><a href="../classes/control.lib.html">control.lib</a></li>
            
                <li><a href="../classes/control.lib.activity.html">control.lib.activity</a></li>
            
                <li><a href="../classes/control.lib.din.html">control.lib.din</a></li>
            
                <li><a href="../classes/control.lib.din.pin.html">control.lib.din.pin</a></li>
            
                <li><a href="../classes/control.lib.distributor.html">control.lib.distributor</a></li>
            
                <li><a href="../classes/control.lib.door.html">control.lib.door</a></li>
            
                <li><a href="../classes/control.lib.door.pin.html">control.lib.door.pin</a></li>
            
                <li><a href="../classes/control.lib.flowMeter.html">control.lib.flowMeter</a></li>
            
                <li><a href="../classes/control.lib.heater.html">control.lib.heater</a></li>
            
                <li><a href="../classes/control.lib.heater.pin.html">control.lib.heater.pin</a></li>
            
                <li><a href="../classes/control.lib.heater.tariff.html">control.lib.heater.tariff</a></li>
            
                <li><a href="../classes/control.lib.light.html">control.lib.light</a></li>
            
                <li><a href="../classes/control.lib.light.pin.html">control.lib.light.pin</a></li>
            
                <li><a href="../classes/control.lib.light.remote.html">control.lib.light.remote</a></li>
            
                <li><a href="../classes/control.lib.light.switch.html">control.lib.light.switch</a></li>
            
                <li><a href="../classes/control.lib.pin.html">control.lib.pin</a></li>
            
                <li><a href="../classes/control.lib.pin.commands.html">control.lib.pin.commands</a></li>
            
                <li><a href="../classes/control.lib.pin.counter.html">control.lib.pin.counter</a></li>
            
                <li><a href="../classes/control.lib.pin.din.html">control.lib.pin.din</a></li>
            
                <li><a href="../classes/control.lib.pin.dout.html">control.lib.pin.dout</a></li>
            
                <li><a href="../classes/control.lib.pin.light.html">control.lib.pin.light</a></li>
            
                <li><a href="../classes/control.lib.pin.list.html">control.lib.pin.list</a></li>
            
                <li><a href="../classes/control.lib.pin.pwm.html">control.lib.pin.pwm</a></li>
            
                <li><a href="../classes/control.lib.pin.switch.html">control.lib.pin.switch</a></li>
            
                <li><a href="../classes/control.lib.remote.html">control.lib.remote</a></li>
            
                <li><a href="../classes/control.lib.room.html">control.lib.room</a></li>
            
                <li><a href="../classes/control.lib.switch.html">control.lib.switch</a></li>
            
                <li><a href="../classes/control.lib.switch.relay.html">control.lib.switch.relay</a></li>
            
                <li><a href="../classes/control.lib.switch.socket.html">control.lib.switch.socket</a></li>
            
                <li><a href="../classes/dvb.content.html">dvb.content</a></li>
            
                <li><a href="../classes/dvb.lib.html">dvb.lib</a></li>
            
                <li><a href="../classes/dvb.lib.channel.html">dvb.lib.channel</a></li>
            
                <li><a href="../classes/fs.content.html">fs.content</a></li>
            
                <li><a href="../classes/fs.lib.html">fs.lib</a></li>
            
                <li><a href="../classes/fs.lib.dir.html">fs.lib.dir</a></li>
            
                <li><a href="../classes/fs.lib.file.html">fs.lib.file</a></li>
            
                <li><a href="../classes/icecast.content.html">icecast.content</a></li>
            
                <li><a href="../classes/icecast.lib.html">icecast.lib</a></li>
            
                <li><a href="../classes/icecast.lib.stream.html">icecast.lib.stream</a></li>
            
                <li><a href="../classes/lirc.content.html">lirc.content</a></li>
            
                <li><a href="../classes/lirc.lib.html">lirc.lib</a></li>
            
                <li><a href="../classes/lirc.lib.lirc.html">lirc.lib.lirc</a></li>
            
                <li><a href="../classes/media.content.html">media.content</a></li>
            
                <li><a href="../classes/media.lib.html">media.lib</a></li>
            
                <li><a href="../classes/media.lib.item.html">media.lib.item</a></li>
            
                <li><a href="../classes/media.lib.player.html">media.lib.player</a></li>
            
                <li><a href="../classes/media.lib.player.commands.html">media.lib.player.commands</a></li>
            
                <li><a href="../classes/media.lib.player.dvb.html">media.lib.player.dvb</a></li>
            
                <li><a href="../classes/media.lib.player.playback.html">media.lib.player.playback</a></li>
            
                <li><a href="../classes/media.lib.player.volume.html">media.lib.player.volume</a></li>
            
                <li><a href="../classes/media.lib.sources.html">media.lib.sources</a></li>
            
                <li><a href="../classes/media.lib.stream.html">media.lib.stream</a></li>
            
                <li><a href="../classes/ose.content.html">ose.content</a></li>
            
                <li><a href="../classes/ose.core.html">ose.core</a></li>
            
                <li><a href="../classes/ose.lib.browser.html">ose.lib.browser</a></li>
            
                <li><a href="../classes/ose.lib.cli.html">ose.lib.cli</a></li>
            
                <li><a href="../classes/ose.lib.counter.html">ose.lib.counter</a></li>
            
                <li><a href="../classes/ose.lib.entry.html">ose.lib.entry</a></li>
            
                <li><a href="../classes/ose.lib.entry.link.html">ose.lib.entry.link</a></li>
            
                <li><a href="../classes/ose.lib.entry.master.html">ose.lib.entry.master</a></li>
            
                <li><a href="../classes/ose.lib.entry.slave.html">ose.lib.entry.slave</a></li>
            
                <li><a href="../classes/ose.lib.http.html">ose.lib.http</a></li>
            
                <li><a href="../classes/ose.lib.http.content.html">ose.lib.http.content</a></li>
            
                <li><a href="../classes/ose.lib.kind.html">ose.lib.kind</a></li>
            
                <li><a href="../classes/ose.lib.link.html">ose.lib.link</a></li>
            
                <li><a href="../classes/ose.lib.logger.html">ose.lib.logger</a></li>
            
                <li><a href="../classes/ose.lib.node.html">ose.lib.node</a></li>
            
                <li><a href="../classes/ose.lib.peer.here.html">ose.lib.peer.here</a></li>
            
                <li><a href="../classes/ose.lib.peer.list.html">ose.lib.peer.list</a></li>
            
                <li><a href="../classes/ose.lib.peer.remote.html">ose.lib.peer.remote</a></li>
            
                <li><a href="../classes/ose.lib.peer.rx.html">ose.lib.peer.rx</a></li>
            
                <li><a href="../classes/ose.lib.plugins.html">ose.lib.plugins</a></li>
            
                <li><a href="../classes/ose.lib.scope.html">ose.lib.scope</a></li>
            
                <li><a href="../classes/ose.lib.shard.html">ose.lib.shard</a></li>
            
                <li><a href="../classes/ose.lib.shard.master.html">ose.lib.shard.master</a></li>
            
                <li><a href="../classes/ose.lib.shard.slave.html">ose.lib.shard.slave</a></li>
            
                <li><a href="../classes/ose.lib.space.html">ose.lib.space</a></li>
            
                <li><a href="../classes/ose.lib.space.list.html">ose.lib.space.list</a></li>
            
                <li><a href="../classes/ose.lib.ws.html">ose.lib.ws</a></li>
            
                <li><a href="../classes/ose.lib.ws.browser.html">ose.lib.ws.browser</a></li>
            
                <li><a href="../classes/ose.lib.ws.master.html">ose.lib.ws.master</a></li>
            
                <li><a href="../classes/ose.lib.ws.node.html">ose.lib.ws.node</a></li>
            
                <li><a href="../classes/ose.lib.ws.relay.html">ose.lib.ws.relay</a></li>
            
                <li><a href="../classes/ose.lib.ws.slave.html">ose.lib.ws.slave</a></li>
            
                <li><a href="../classes/ose.wrap.class.html">ose.wrap.class</a></li>
            
                <li><a href="../classes/ose.wrap.common.html">ose.wrap.common</a></li>
            
                <li><a href="../classes/ose.wrap.module.html">ose.wrap.module</a></li>
            
                <li><a href="../classes/ose.wrap.package.html">ose.wrap.package</a></li>
            
                <li><a href="../classes/ose.wrap.singleton.html">ose.wrap.singleton</a></li>
            
                <li><a href="../classes/pa.content.html">pa.content</a></li>
            
                <li><a href="../classes/pa.lib.html">pa.lib</a></li>
            
                <li><a href="../classes/pa.lib.dbus.html">pa.lib.dbus</a></li>
            
                <li><a href="../classes/rpi.content.html">rpi.content</a></li>
            
                <li><a href="../classes/rpi.lib.html">rpi.lib</a></li>
            
                <li><a href="../classes/rpi.lib.camera.html">rpi.lib.camera</a></li>
            
                <li><a href="../classes/rpi.lib.rpi.html">rpi.lib.rpi</a></li>
            
                <li><a href="../classes/videolan.content.html">videolan.content</a></li>
            
                <li><a href="../classes/videolan.lib.html">videolan.lib</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.html">videolan.lib.dvblast</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.master.html">videolan.lib.dvblast.master</a></li>
            
                <li><a href="../classes/videolan.lib.vlc.html">videolan.lib.vlc</a></li>
            
                <li><a href="../classes/xorg.content.html">xorg.content</a></li>
            
                <li><a href="../classes/xorg.lib.html">xorg.lib</a></li>
            
                <li><a href="../classes/xorg.lib.xorg.html">xorg.lib.xorg</a></li>
            
                <li><a href="../classes/youtube.content.html">youtube.content</a></li>
            
                <li><a href="../classes/youtube.lib.html">youtube.lib</a></li>
            
                <li><a href="../classes/youtube.lib.video.html">youtube.lib.video</a></li>
            
        </ul>
    </div>
</div>


      </div>

      <div id="main" class="yui3-u">
        <div class="content"><h4>../bb/lib/widget/slider.js</h4>

<pre class="code prettyprint linenums">
&#x27;use strict&#x27;;

var Ose = require(&#x27;ose&#x27;);
var M = Ose.class(module, &#x27;./index&#x27;);

/** Docs {{{1
 * @submodule bb.widget
 */

/**
 * @caption Slider widget
 *
 * @readme
 * Widget for displaying and controlling HTML sliders.
 *
 * @class bb.lib.widget.slider
 * @type class
 * @extends bb.lib.widget
 */

// Public {{{1
exports.html = function(prop) {  // {{{2
  var button = $(&#x27;&lt;button&gt;&#x27;, {})
    .on(&#x27;click&#x27;, onButtonClick.bind(this))
    .append(&#x27;handler&#x27;)
  ;

  var hammer = new Hammer(button[0]);
  hammer.get(&#x27;pan&#x27;).set({direction: Hammer.DIRECTION_HORIZONTAL});
  button.on(&#x27;panstart&#x27;, onDragstart.bind(this));
  button.on(&#x27;panend&#x27;, onDragend.bind(this));
  button.on(&#x27;panmove&#x27;, Ose._.throttle(onDrag.bind(this), 50));

  /*
          swipe: false,
          dragLockToAxis: true,
          dragBlockVertical: true,
          dragup: false,
          dragdown: false
        })
//        .on(&#x27;dragstart&#x27;, onDragstart.bind(this))
        .on(&#x27;panstart&#x27;, onDragstart.bind(this))
*/

  var result = $(&#x27;&lt;div&gt;&#x27;, {
    role: &#x27;slider&#x27;,
    &#x27;class&#x27;: &#x27;handleResize&#x27;
  })
    .on(&#x27;click&#x27;, onClick.bind(this))
    .on(&#x27;mouseup&#x27;, onMouseup.bind(this))
    .on(&#x27;resize&#x27;, Ose._.throttle(onResize.bind(this), 200))
    .append($(&#x27;&lt;span&gt;&#x27;))
    .append($(&#x27;&lt;div&gt;&#x27;)
      .append($(&#x27;&lt;progress&gt;&#x27;, {}))
      .append(button)
    )
  ;

  return result;
};

exports.val = function(el) {  // {{{2
  return this.value;
};

exports.update = function(el, prop, origin) {  // {{{2
  switch (typeof el) {
    case undefined:
    case &#x27;number&#x27;:
    case &#x27;string&#x27;:
      el = this.$();
      break;
  }

  if (! ((el instanceof jQuery) &amp;&amp; (el.length === 1))) {
    throw new Error(&#x27;Slider not found!&#x27;);
  }

  var progress = el.find(&#x27;progress&#x27;);

  switch (typeof prop) {
    case &#x27;object&#x27;:
      break;
    case &#x27;null&#x27;:
    case &#x27;undefined&#x27;:
      prop = {};
      break;
    case &#x27;function&#x27;:
      prop = {change: prop};
      break;
    default:
      prop = {value: prop};
  }

  if (! (&#x27;value&#x27; in this)) {
    if (! (&#x27;min&#x27; in prop)) prop.min = 0;
    if (! (&#x27;max&#x27; in prop)) prop.max = 100;
    if (! (&#x27;value&#x27; in prop)) prop.value = prop.min;
  }

  if (&#x27;label&#x27; in prop) el.find(&#x27;span&#x27;).text(prop.label);

  if ((&#x27;min&#x27; in prop) &amp;&amp; (this.min !== prop.min)) {
    this.min = prop.min;
    el.attr(&#x27;aria-valuemin&#x27;, this.min);
    progress.attr(&#x27;min&#x27;, this.min);
  }

  if ((&#x27;max&#x27; in prop) &amp;&amp; (this.max !== prop.max)) {
    this.max = prop.max;
    el.attr(&#x27;aria-valuemax&#x27;, this.max);
    progress.attr(&#x27;max&#x27;, this.max);
  }

  if (&#x27;value&#x27; in prop) {
    if (this.dragging) delete prop.value;  // Disable remote value change when user is dragging.
  }

  if (&#x27;hide&#x27; in prop) {
    if (prop.hide) {
      el.hide();
    } else {
      el.show();
    }
  }

  if (&#x27;change&#x27; in prop) {
    el.off(&#x27;change&#x27;);

    if (prop.change) {
      el.on(&#x27;change&#x27;, prop.change);
    }
  }

  switch (typeof prop.state) {
    case &#x27;undefined&#x27;:
      break;
    case &#x27;object&#x27;:
      if (prop.state === null) {
        delete this.buttonClick;
      } else {
        M.log.unhandled(&#x27;Button click handler&#x27;, prop.state);
      }

      break;
    case &#x27;function&#x27;:
      this.buttonClick = prop.state;

      break;
    case &#x27;boolean&#x27;:
    case &#x27;number&#x27;:
    case &#x27;string&#x27;:
      if (prop.state) {  // TODO: Shouldn&#x27;t be this condition reversed? Or better property name?
        el.removeClass(&#x27;disabled&#x27;)
      } else {
        el.addClass(&#x27;disabled&#x27;)
      }
      break;
    default:
      M.log.unhandled(&#x27;Unexpected value of prop.state.&#x27;, prop.state);
  };

  if (&#x27;duration&#x27; in prop) {
    var duration = prop.duration;

    switch (duration) {
      case 0:
      case &#x27;0&#x27;:
      case false:
      case null:
      case undefined:
        duration = 0;
        break;
      case true:
        duration = this.max - this.min;
    }

    switch (typeof duration) {
      case &#x27;number&#x27;:
        break;
      case &#x27;string&#x27;:
        duration = parseFloat(duration);
        if (isNaN(duration)) {
          duration = 0;
          M.log.unhandled(&#x27;Duration cannot be parsed to float.&#x27;, prop.duration);
        }
        break;
      default:
        M.log.unhandled(&#x27;Invalid duration.&#x27;);
    }

    if (duration) {
      this.duration = {
        value: duration,
        at: new Date().getTime()
      };
    } else {
      delete this.duration;
    }
  }

  update(this, el, prop.value, undefined, origin || &#x27;control&#x27;);

  return this.value;
};

// }}}1
// Event Handlers  {{{1
function onResize(ev) {  // {{{2
  update(this, $(ev.currentTarget));
};

function onButtonClick(ev) {  // {{{2
  if (this.ignoreButtonClick) {
    delete this.ignoreButtonClick;
  } else {
    this.buttonClick &amp;&amp; this.buttonClick(ev);
  }

  return false;
};

function onClick(ev) {  // {{{2
  update(this, null, null, ev.pageX - this.$(&#x27; progress&#x27;).offset().left, &#x27;click&#x27;);

  return false;
};

function onDragstart(ev) {  // {{{2
  console.log(&#x27;DRAGSTART&#x27;, ev.gesture.direction, ev.gesture.offsetDirection);

  switch (ev.gesture.offsetDirection) {
    case Hammer.DIRECTION_RIGHT:
    case Hammer.DIRECTION_LEFT:

      delete this.duration;

      this.$(&#x27; button&#x27;).stop();

      this.dragging = {
        offset: ev.gesture.pointers[0].pageX
          + parseInt(this.$(&#x27; div&#x27;).css(&#x27;padding-left&#x27;))
          - parseInt(this.$(&#x27; button&#x27;).css(&#x27;left&#x27;))
      };

      return false;
  }

  return;
};

function onDrag(ev) {  // {{{2
  if (! this.dragging) return;

  switch (ev.gesture.direction) {
    case Hammer.DIRECTION_RIGHT:
    case Hammer.DIRECTION_LEFT:
      update(this, null, null, ev.gesture.pointers[0].pageX - this.dragging.offset, &#x27;drag&#x27;);

      return false;
  }

  return;
};

function onDragend(ev) {  // {{{2
  if (this.dragging) {
    update(this, null, null, ev.gesture.pointers[0].pageX - this.dragging.offset, &#x27;drag&#x27;);

    delete this.dragging;
  }

  return false;
};

function onMouseup(ev) {  // {{{2
  if (this.dragging) {
    this.ignoreButtonClick = true;
  }
};

// }}}1
// Private {{{1
function update(that, el, value, pos, origin) {  // {{{2
//  console.log(&#x27;SLIDER UPDATE&#x27;, that.id, origin, {value: value, pos: pos, duration: that.duration});

  if (! (el &amp;&amp; el.length)) {
    el = that.$();
  }

  var button = el.find(&#x27;button&#x27;);
  var padding = parseInt(el.find(&#x27;div&#x27;).css(&#x27;padding-left&#x27;));
  var progress = el.find(&#x27;progress&#x27;);
  var progressWidth = progress.width();

  switch (value) {
    case undefined:
      if (that.duration &amp;&amp; (&#x27;start&#x27; in that.duration)) {
        value = that.duration.start + (new Date().getTime() - that.duration.at) / 1000;
      } else {
        value = that.value;
      }
      break;
    case null:
    case false:
    case &#x27;off&#x27;:
      value = that.min;
      break;
    case true:
    case &#x27;on&#x27;:
      value = that.max;
      break;
    default:
      if (typeof value === &#x27;string&#x27;) value = parseInt(value);
  }

  if (pos === undefined) {
    if (value &lt; that.min) value = that.min;
    if (value &gt; that.max) value = that.max;

    pos = progressWidth * value / (that.max - that.min);
  } else {
    if (pos &lt; 0) pos = 0;
    if (pos &gt; progressWidth) pos = progressWidth;

    value = (that.max - that.min) * (pos / progressWidth);
  }

  if ((typeof value !== &#x27;number&#x27;) || isNaN(value)) {
    throw new Error(&#x27;Can\&#x27;t set NaN values to el! &#x27; + value);
  }

  that.value = value;

  button
    .stop()
    .css(&#x27;left&#x27;, pos + padding)
  ;

  el.attr(&#x27;aria-valuenow&#x27;, value);
  el.val(value);
  progress.val(value);

  switch (origin) {
    case &#x27;click&#x27;:
    case &#x27;drag&#x27;:
      delete that.duration;
      el.trigger(&#x27;change&#x27;);
      break;
    default:
      if (that.duration) {
        animate();
      }
  }

  function animate() {  // {{{3
    if (! (&#x27;start&#x27; in that.duration)) {
      that.duration.start = that.value;
    }

    var wait = button.width() * that.duration.value / progressWidth / 4;
    if (wait &gt; 1000) {
      wait = 1000;
    }

    button
      .stop()
      .animate(
        {
          left: progressWidth + padding
        }, {
          easing: &#x27;linear&#x27;,
          duration: Math.round(that.duration.value * (that.max - value) / that.max),
          progress: Ose._.throttle(onProgress, wait, {leading: false})
        }
      )
    ;
  };

  function onProgress(anim) {  // {{{3
    if (! that.duration) {
      return;
    }

    that.value = (that.max - that.min) * (parseFloat(button.css(&#x27;left&#x27;)) - padding) / progressWidth;

    el.attr(&#x27;aria-valuenow&#x27;, that.value);
    el.val(that.value);
    progress.val(that.value);

    return;
  };

  // }}}3
};

// }}}1

</pre>

</div>
      </div>

    </div>
  </div>
  <script src="../assets/vendor/prettify/prettify-min.js"></script>
  <script>prettyPrint();</script>
  <script src="../assets/js/yui-prettify.js"></script>
  <!--script src="../assets/js/tabs.js"></script-->
  <script src="../assets/js/ose.js"></script>
</body>
</html>
