<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>doc.js - ose-bundle</title>
  <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
  <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
  <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
  <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.4/zepto.min.js"></script>
</head>
<body class="yui3-skin-sam">

  <div id="doc">
    <div class="yui3-g">

      <div id="sidebar" class="yui3-u">
        <a href="../index.html"><h2>OSE documentation</h2></a>

        <div class="sidebox">
          <div class="hd">
            <h2 class="no-toc">Type to filter sidebar:</h2>
          </div>
          <div class="bd">
            <input id="filter-input" />
          </div>
        </div>

        







<div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All packages and components</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/bb.html">bb</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/bb.html#bb.box">bb.box</a></li> -->
                            <li><a href="../modules/bb.box.html">bb.box</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.dialog">bb.dialog</a></li> -->
                            <li><a href="../modules/bb.dialog.html">bb.dialog</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.pagelet">bb.pagelet</a></li> -->
                            <li><a href="../modules/bb.pagelet.html">bb.pagelet</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.widget">bb.widget</a></li> -->
                            <li><a href="../modules/bb.widget.html">bb.widget</a></li>
                        
                            <!-- <li><a href="../modules/bb.html#bb.stateObj">bb.stateObj</a></li> -->
                            <li><a href="../modules/bb.stateObj.html">bb.stateObj</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/boards.html">boards</a>
                
                </li>
            
                <li><a href="../modules/bundle.html">bundle</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/bundle.html#bundle.media">bundle.media</a></li> -->
                            <li><a href="../modules/bundle.media.html">bundle.media</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/control.html">control</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/control.html#control.distributor">control.distributor</a></li> -->
                            <li><a href="../modules/control.distributor.html">control.distributor</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.pin">control.pin</a></li> -->
                            <li><a href="../modules/control.pin.html">control.pin</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.room">control.room</a></li> -->
                            <li><a href="../modules/control.room.html">control.room</a></li>
                        
                            <!-- <li><a href="../modules/control.html#control.remote">control.remote</a></li> -->
                            <li><a href="../modules/control.remote.html">control.remote</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/dvb.html">dvb</a>
                
                </li>
            
                <li><a href="../modules/fs.html">fs</a>
                
                </li>
            
                <li><a href="../modules/icecast.html">icecast</a>
                
                </li>
            
                <li><a href="../modules/lirc.html">lirc</a>
                
                </li>
            
                <li><a href="../modules/media.html">media</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/media.html#media.history">media.history</a></li> -->
                            <li><a href="../modules/media.history.html">media.history</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.player">media.player</a></li> -->
                            <li><a href="../modules/media.player.html">media.player</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.stream">media.stream</a></li> -->
                            <li><a href="../modules/media.stream.html">media.stream</a></li>
                        
                            <!-- <li><a href="../modules/media.html#media.source">media.source</a></li> -->
                            <li><a href="../modules/media.source.html">media.source</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/ose.html">ose</a>
                
                    <ul>
                        
                            <!-- <li><a href="../modules/ose.html#ose.data">ose.data</a></li> -->
                            <li><a href="../modules/ose.data.html">ose.data</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.http">ose.http</a></li> -->
                            <li><a href="../modules/ose.http.html">ose.http</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.peer">ose.peer</a></li> -->
                            <li><a href="../modules/ose.peer.html">ose.peer</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.link">ose.link</a></li> -->
                            <li><a href="../modules/ose.link.html">ose.link</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.logger">ose.logger</a></li> -->
                            <li><a href="../modules/ose.logger.html">ose.logger</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.plugin">ose.plugin</a></li> -->
                            <li><a href="../modules/ose.plugin.html">ose.plugin</a></li>
                        
                            <!-- <li><a href="../modules/ose.html#ose.wrap">ose.wrap</a></li> -->
                            <li><a href="../modules/ose.wrap.html">ose.wrap</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/pa.html">pa</a>
                
                </li>
            
                <li><a href="../modules/rpi.html">rpi</a>
                
                </li>
            
                <li><a href="../modules/videolan.html">videolan</a>
                
                </li>
            
                <li><a href="../modules/xorg.html">xorg</a>
                
                </li>
            
                <li><a href="../modules/yoctopuce.html">yoctopuce</a>
                
                </li>
            
                <li><a href="../modules/youtube.html">youtube</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/bb.content.html">bb.content</a></li>
            
                <li><a href="../classes/bb.lib.html">bb.lib</a></li>
            
                <li><a href="../classes/bb.lib.box.content.html">bb.lib.box.content</a></li>
            
                <li><a href="../classes/bb.lib.box.left.html">bb.lib.box.left</a></li>
            
                <li><a href="../classes/bb.lib.dialog.html">bb.lib.dialog</a></li>
            
                <li><a href="../classes/bb.lib.dialog.action.html">bb.lib.dialog.action</a></li>
            
                <li><a href="../classes/bb.lib.dialog.confirm.html">bb.lib.dialog.confirm</a></li>
            
                <li><a href="../classes/bb.lib.dialog.info.html">bb.lib.dialog.info</a></li>
            
                <li><a href="../classes/bb.lib.dialog.valueSelector.html">bb.lib.dialog.valueSelector</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.html">bb.lib.pagelet</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.dashboard.html">bb.lib.pagelet.dashboard</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.detail.html">bb.lib.pagelet.detail</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.entry.html">bb.lib.pagelet.entry</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.gesture.html">bb.lib.pagelet.gesture</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.list.html">bb.lib.pagelet.list</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.listItem.html">bb.lib.pagelet.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.html">bb.lib.widget</a></li>
            
                <li><a href="../classes/bb.lib.widget.button.html">bb.lib.widget.button</a></li>
            
                <li><a href="../classes/bb.lib.widget.checkbox.html">bb.lib.widget.checkbox</a></li>
            
                <li><a href="../classes/bb.lib.widget.list.html">bb.lib.widget.list</a></li>
            
                <li><a href="../classes/bb.lib.widget.listItem.html">bb.lib.widget.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.search.html">bb.lib.widget.search</a></li>
            
                <li><a href="../classes/bb.lib.widget.slider.html">bb.lib.widget.slider</a></li>
            
                <li><a href="../classes/bb.lib.widget.slideswitch.html">bb.lib.widget.slideswitch</a></li>
            
                <li><a href="../classes/bb.lib.widget.toolbar.html">bb.lib.widget.toolbar</a></li>
            
                <li><a href="../classes/boards.content.html">boards.content</a></li>
            
                <li><a href="../classes/boards.lib.html">boards.lib</a></li>
            
                <li><a href="../classes/bundle.doc.html">bundle.doc</a></li>
            
                <li><a href="../classes/bundle.example.media.html">bundle.example.media</a></li>
            
                <li><a href="../classes/bundle.examples.media.config.html">bundle.examples.media.config</a></li>
            
                <li><a href="../classes/bundle.Gruntfile.html">bundle.Gruntfile</a></li>
            
                <li><a href="../classes/control.content.html">control.content</a></li>
            
                <li><a href="../classes/control.lib.html">control.lib</a></li>
            
                <li><a href="../classes/control.lib.activity.html">control.lib.activity</a></li>
            
                <li><a href="../classes/control.lib.din.html">control.lib.din</a></li>
            
                <li><a href="../classes/control.lib.din.pin.html">control.lib.din.pin</a></li>
            
                <li><a href="../classes/control.lib.distributor.html">control.lib.distributor</a></li>
            
                <li><a href="../classes/control.lib.door.html">control.lib.door</a></li>
            
                <li><a href="../classes/control.lib.door.pin.html">control.lib.door.pin</a></li>
            
                <li><a href="../classes/control.lib.flowMeter.html">control.lib.flowMeter</a></li>
            
                <li><a href="../classes/control.lib.heater.html">control.lib.heater</a></li>
            
                <li><a href="../classes/control.lib.heater.pin.html">control.lib.heater.pin</a></li>
            
                <li><a href="../classes/control.lib.heater.tariff.html">control.lib.heater.tariff</a></li>
            
                <li><a href="../classes/control.lib.light.html">control.lib.light</a></li>
            
                <li><a href="../classes/control.lib.light.pin.html">control.lib.light.pin</a></li>
            
                <li><a href="../classes/control.lib.light.remote.html">control.lib.light.remote</a></li>
            
                <li><a href="../classes/control.lib.light.switch.html">control.lib.light.switch</a></li>
            
                <li><a href="../classes/control.lib.pin.html">control.lib.pin</a></li>
            
                <li><a href="../classes/control.lib.pin.commands.html">control.lib.pin.commands</a></li>
            
                <li><a href="../classes/control.lib.pin.counter.html">control.lib.pin.counter</a></li>
            
                <li><a href="../classes/control.lib.pin.din.html">control.lib.pin.din</a></li>
            
                <li><a href="../classes/control.lib.pin.dout.html">control.lib.pin.dout</a></li>
            
                <li><a href="../classes/control.lib.pin.light.html">control.lib.pin.light</a></li>
            
                <li><a href="../classes/control.lib.pin.list.html">control.lib.pin.list</a></li>
            
                <li><a href="../classes/control.lib.pin.pwm.html">control.lib.pin.pwm</a></li>
            
                <li><a href="../classes/control.lib.pin.switch.html">control.lib.pin.switch</a></li>
            
                <li><a href="../classes/control.lib.remote.html">control.lib.remote</a></li>
            
                <li><a href="../classes/control.lib.room.html">control.lib.room</a></li>
            
                <li><a href="../classes/control.lib.switch.html">control.lib.switch</a></li>
            
                <li><a href="../classes/control.lib.switch.relay.html">control.lib.switch.relay</a></li>
            
                <li><a href="../classes/control.lib.switch.socket.html">control.lib.switch.socket</a></li>
            
                <li><a href="../classes/dvb.content.html">dvb.content</a></li>
            
                <li><a href="../classes/dvb.lib.html">dvb.lib</a></li>
            
                <li><a href="../classes/dvb.lib.channel.html">dvb.lib.channel</a></li>
            
                <li><a href="../classes/fs.content.html">fs.content</a></li>
            
                <li><a href="../classes/fs.lib.html">fs.lib</a></li>
            
                <li><a href="../classes/fs.lib.dir.html">fs.lib.dir</a></li>
            
                <li><a href="../classes/fs.lib.file.html">fs.lib.file</a></li>
            
                <li><a href="../classes/icecast.content.html">icecast.content</a></li>
            
                <li><a href="../classes/icecast.lib.html">icecast.lib</a></li>
            
                <li><a href="../classes/icecast.lib.stream.html">icecast.lib.stream</a></li>
            
                <li><a href="../classes/lirc.content.html">lirc.content</a></li>
            
                <li><a href="../classes/lirc.lib.html">lirc.lib</a></li>
            
                <li><a href="../classes/lirc.lib.lirc.html">lirc.lib.lirc</a></li>
            
                <li><a href="../classes/media.content.html">media.content</a></li>
            
                <li><a href="../classes/media.lib.html">media.lib</a></li>
            
                <li><a href="../classes/media.lib.item.html">media.lib.item</a></li>
            
                <li><a href="../classes/media.lib.player.html">media.lib.player</a></li>
            
                <li><a href="../classes/media.lib.player.commands.html">media.lib.player.commands</a></li>
            
                <li><a href="../classes/media.lib.player.dvb.html">media.lib.player.dvb</a></li>
            
                <li><a href="../classes/media.lib.player.playback.html">media.lib.player.playback</a></li>
            
                <li><a href="../classes/media.lib.player.volume.html">media.lib.player.volume</a></li>
            
                <li><a href="../classes/media.lib.sources.html">media.lib.sources</a></li>
            
                <li><a href="../classes/media.lib.stream.html">media.lib.stream</a></li>
            
                <li><a href="../classes/ose.content.html">ose.content</a></li>
            
                <li><a href="../classes/ose.core.html">ose.core</a></li>
            
                <li><a href="../classes/ose.lib.browser.html">ose.lib.browser</a></li>
            
                <li><a href="../classes/ose.lib.cli.html">ose.lib.cli</a></li>
            
                <li><a href="../classes/ose.lib.counter.html">ose.lib.counter</a></li>
            
                <li><a href="../classes/ose.lib.entry.html">ose.lib.entry</a></li>
            
                <li><a href="../classes/ose.lib.entry.link.html">ose.lib.entry.link</a></li>
            
                <li><a href="../classes/ose.lib.entry.master.html">ose.lib.entry.master</a></li>
            
                <li><a href="../classes/ose.lib.entry.slave.html">ose.lib.entry.slave</a></li>
            
                <li><a href="../classes/ose.lib.http.html">ose.lib.http</a></li>
            
                <li><a href="../classes/ose.lib.http.content.html">ose.lib.http.content</a></li>
            
                <li><a href="../classes/ose.lib.kind.html">ose.lib.kind</a></li>
            
                <li><a href="../classes/ose.lib.link.html">ose.lib.link</a></li>
            
                <li><a href="../classes/ose.lib.logger.html">ose.lib.logger</a></li>
            
                <li><a href="../classes/ose.lib.node.html">ose.lib.node</a></li>
            
                <li><a href="../classes/ose.lib.peer.here.html">ose.lib.peer.here</a></li>
            
                <li><a href="../classes/ose.lib.peer.list.html">ose.lib.peer.list</a></li>
            
                <li><a href="../classes/ose.lib.peer.remote.html">ose.lib.peer.remote</a></li>
            
                <li><a href="../classes/ose.lib.peer.rx.html">ose.lib.peer.rx</a></li>
            
                <li><a href="../classes/ose.lib.plugins.html">ose.lib.plugins</a></li>
            
                <li><a href="../classes/ose.lib.scope.html">ose.lib.scope</a></li>
            
                <li><a href="../classes/ose.lib.shard.html">ose.lib.shard</a></li>
            
                <li><a href="../classes/ose.lib.shard.master.html">ose.lib.shard.master</a></li>
            
                <li><a href="../classes/ose.lib.shard.slave.html">ose.lib.shard.slave</a></li>
            
                <li><a href="../classes/ose.lib.space.html">ose.lib.space</a></li>
            
                <li><a href="../classes/ose.lib.space.list.html">ose.lib.space.list</a></li>
            
                <li><a href="../classes/ose.lib.ws.html">ose.lib.ws</a></li>
            
                <li><a href="../classes/ose.lib.ws.browser.html">ose.lib.ws.browser</a></li>
            
                <li><a href="../classes/ose.lib.ws.master.html">ose.lib.ws.master</a></li>
            
                <li><a href="../classes/ose.lib.ws.node.html">ose.lib.ws.node</a></li>
            
                <li><a href="../classes/ose.lib.ws.relay.html">ose.lib.ws.relay</a></li>
            
                <li><a href="../classes/ose.lib.ws.slave.html">ose.lib.ws.slave</a></li>
            
                <li><a href="../classes/ose.wrap.class.html">ose.wrap.class</a></li>
            
                <li><a href="../classes/ose.wrap.common.html">ose.wrap.common</a></li>
            
                <li><a href="../classes/ose.wrap.module.html">ose.wrap.module</a></li>
            
                <li><a href="../classes/ose.wrap.package.html">ose.wrap.package</a></li>
            
                <li><a href="../classes/ose.wrap.singleton.html">ose.wrap.singleton</a></li>
            
                <li><a href="../classes/pa.content.html">pa.content</a></li>
            
                <li><a href="../classes/pa.lib.html">pa.lib</a></li>
            
                <li><a href="../classes/pa.lib.dbus.html">pa.lib.dbus</a></li>
            
                <li><a href="../classes/rpi.content.html">rpi.content</a></li>
            
                <li><a href="../classes/rpi.lib.html">rpi.lib</a></li>
            
                <li><a href="../classes/rpi.lib.camera.html">rpi.lib.camera</a></li>
            
                <li><a href="../classes/rpi.lib.rpi.html">rpi.lib.rpi</a></li>
            
                <li><a href="../classes/videolan.content.html">videolan.content</a></li>
            
                <li><a href="../classes/videolan.lib.html">videolan.lib</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.html">videolan.lib.dvblast</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.master.html">videolan.lib.dvblast.master</a></li>
            
                <li><a href="../classes/videolan.lib.vlc.html">videolan.lib.vlc</a></li>
            
                <li><a href="../classes/xorg.content.html">xorg.content</a></li>
            
                <li><a href="../classes/xorg.lib.html">xorg.lib</a></li>
            
                <li><a href="../classes/xorg.lib.xorg.html">xorg.lib.xorg</a></li>
            
                <li><a href="../classes/yoctopuce.content.html">yoctopuce.content</a></li>
            
                <li><a href="../classes/yoctopuce.lib.html">yoctopuce.lib</a></li>
            
                <li><a href="../classes/yoctopuce.lib.meteo.html">yoctopuce.lib.meteo</a></li>
            
                <li><a href="../classes/youtube.content.html">youtube.content</a></li>
            
                <li><a href="../classes/youtube.lib.html">youtube.lib</a></li>
            
                <li><a href="../classes/youtube.lib.video.html">youtube.lib.video</a></li>
            
        </ul>
    </div>
</div>


      </div>

      <div id="main" class="yui3-u">
        <div class="content"><h4>doc.js</h4>

<pre class="code prettyprint linenums">
&#x27;use strict&#x27;;

/* TODO:
 *
 * CROSS NOT FOUND GitHub
 * links for README files for individual packages
 *
 */

var _ = require(&#x27;underscore&#x27;);
var Marked = require(&#x27;marked&#x27;);
var Y = require(&#x27;yuidocjs&#x27;);
var Fs = require(&#x27;fs&#x27;);

/** Doc {{{1
 * @module bundle
 */

/**
 * @caption Documentation build script
 *
 * @readme
 * To build complete documentation, go to the &#x60;bundle&#x60; directory and run:
 *
 *     grunt docs
 *
 * @class bundle.doc
 * @type module
 */

/*
 * Mapping between yui names and OSE names:
 *
 * yui.module == ose.package
 * yui.submodule == ose.component (ose.comp)
 * yui.class == ose.module, module can be a &quot;class&quot;, &quot;singleton&quot;, &quot;module&quot; or &quot;runtime&quot;
 */

// Public {{{1
exports.build = function(grunt, pkg, cb) {  // {{{2
//  Y.Handlebars.registerHelper(&#x27;buildOseFileTree&#x27;, buildFileTree);

  var options = {
    quiet: true,
    outdir: &#x27;../doc&#x27;,
    themedir: &#x27;yui/theme&#x27;,
    linkNatives: &#x27;true&#x27;,
    attributesEmit: &#x27;true&#x27;,
    selleck: &#x27;false&#x27;,
    markdown: &#x27;true&#x27;,
    exclude: &#x27;depends,node_modules&#x27;,
//    parseOnly: &#x27;true&#x27;,
    paths: [
      &#x27;./&#x27;,
      &#x27;../ose&#x27;,
      &#x27;../bb&#x27;,
      &#x27;../boards&#x27;,
      &#x27;../control&#x27;,
      &#x27;../dvb&#x27;,
      &#x27;../fs&#x27;,
      &#x27;../icecast&#x27;,
      &#x27;../media&#x27;,
      &#x27;../lirc&#x27;,
      &#x27;../pa&#x27;,
      &#x27;../rpi&#x27;,
      &#x27;../videolan&#x27;,
      &#x27;../xorg&#x27;,
      &#x27;../yoctopuce&#x27;,
      &#x27;../youtube&#x27;,
    ],
    project: {
      name: pkg.name,
      description: pkg.description,
      version: pkg.version,
      url: pkg.homepage,
    },
  };

  grunt.log.writeln(&#x27;READING ...&#x27;);
  Fs.renameSync(&#x27;../doc/.git&#x27;, &#x27;../OLD_doc&#x27;);
  Json = (new Y.YUIDoc(options)).run();
//  grunt.file.write(&#x27;../doc/data1.json&#x27;, JSON.stringify(Json, null, 2));

  grunt.log.writeln(&#x27;PREPARING ...&#x27;);

  delete Json.warnings;

  Contrib = Json.modules[&#x27;bundle&#x27;].contributions;
  License = Json.modules[&#x27;bundle&#x27;].license;
  Status = Json.modules[&#x27;bundle&#x27;].status;
  Starting = Json.modules[&#x27;bundle&#x27;].getting_started;
  StartingLink = Json.modules[&#x27;bundle&#x27;].getting_started_link;
//  console.log(&#x27;GET START&#x27;, Starting);
//  console.log(&#x27;GET START LINK&#x27;, StartingLink);

  // Prepare
  for (var key in Json.files) prepFile(key);
  for (var key in Json.modules) prepComp(key);
  for (var key in Json.classes) prepModule(key);
  for (var key in Json.classitems) prepModuleItem(key);

//  prepExample(&#x27;bundle.media&#x27;);

//  var readme = [];

  for (var key in Json.classitems) doModuleItem(key);
  for (var key in Json.classes) doModule(key);
  for (var key in Json.modules) doPackage(key);

//  Fs.writeFile(&#x27;../doc/keywords.json&#x27;, JSON.stringify(Keywords, null, 2));
//  Fs.writeFile(&#x27;../doc/data2.json&#x27;, JSON.stringify(Json, null, 2));
//  Fs.writeFile(&#x27;../doc/data.js&#x27;, &#x27;window.doc = &#x27; + JSON.stringify(Json) + &#x27;;&#x27;);
//  grunt.file.write(&#x27;README.md&#x27;, readme.join(&#x27;\n&#x27;));

  var doc = [Json.modules[&#x27;bundle&#x27;].documentation];
  doc.push(&#x27;## Getting started&#x27;);
  doc.push(StartingLink);
  doc.push(&#x27;&#x27;);

  Fs.writeFile(&#x27;yui/theme/partials/index.handlebars&#x27;, Marked(mdKeywords(doc.join(&#x27;\n&#x27;))));

  console.log(&#x27;BUILDING ...&#x27;);
  var builder = new Y.DocBuilder(options, Json);

  builder.compile(function() {
    Fs.renameSync(&#x27;../OLD_doc&#x27;, &#x27;../doc/.git&#x27;);
    grunt.log.writeln(&#x27;DONE&#x27;);
    cb();
  });
};

// }}}1
// Private {{{1
var Keywords = {};
var Json;
var Contrib;
var License;
var Status;
var Starting;
var StartingLink;
var GhUri = &#x27;http://opensmartenvironment.github.io/doc&#x27;;

function prepFile(key) {  // {{{2
//  console.log(&#x27;PREP FILE&#x27;, key);

  var file = Json.files[key];

//  file.name = filename(key);
//  delete Json.files[key];
//  Json.files[filename(key)] = file;

  keyword(key, filename(key));
}

function prepComp(name) {  // {{{2
  var comp = Json.modules[name];
//  comp.file = filename(comp.file);

//  console.log(&#x27;PREP COMP&#x27;, name, comp.aliases);

  if (! comp.is_submodule) {
    if (comp.name === &#x27;ose&#x27;) {
      comp.npmName = &#x27;ose&#x27;;
    } else {
      comp.npmName = &#x27;ose-&#x27; + comp.name;
    }
  }

  keyword(name, comp.caption, comp.aliases);
  if (name !== &#x27;ose&#x27;) {
    keyword(name, &#x27;ose-&#x27; + name);
  }
}

function prepModule(name) {  // {{{2
//  console.log(&#x27;PREP MODULE&#x27;, name);

  var module = Json.classes[name];
//  module.file = filename(module.file);

  keyword(name, module.caption, module.aliases);
}

function prepModuleItem(name) {  // {{{2
//  console.log(&#x27;PREP MODULE ITEM&#x27;, name);

  var item = Json.classitems[name];
//  item.file = filename(item.file);

  keyword(name, null, item.aliases);
}

function prepExample(name) {  // {{{2
  var e = Json.modules[name];

  e.description = [
    &#x27;## Prerequisities&#x27;,
    e.prerequisities,
    &#x27;## Installation&#x27;,
    e.installation,
    &#x27;## Getting it to run&#x27;,
    e.gettingtorun,
    &#x27;## Configuration&#x27;,
    e.configuration,
  ].join(&#x27;\n&#x27;);
}

function doPackage(name) {  // {{{2
//  console.log(&#x27;DO PACKAGE&#x27;, name);

  var comp = Json.modules[name];
  if (comp.is_submodule) return;

  var d = [comp.readme];
  d.push(&#x27;&#x27;);

  if (comp.features) {
    d.push(&#x27;## Features&#x27;);
    d.push(comp.features);
    d.push(&#x27;&#x27;);
  }

  d.push(&#x27;## Status&#x27;);
  d.push(Status);
  d.push(&#x27;&#x27;);

  d.push(&#x27;## Getting started&#x27;);
  if (name === &#x27;bundle&#x27;) {
    d.push(Starting);
  } else {
    d.push(StartingLink);
  }
  d.push(&#x27;&#x27;);

  if (comp.description) {
    d.push(comp.description);
    d.push(&#x27;&#x27;);
  }

  doComps(comp, d);
  doModules(comp, d, true);

  d.push(&#x27;## Contributions&#x27;);
  d.push(Contrib);
  d.push(&#x27;&#x27;);

  d.push(&#x27;## Licence&#x27;);
  d.push(License);
  d.push(&#x27;&#x27;);

  comp.description = crossKeywords(d.join(&#x27;\n&#x27;));

  Fs.writeFile(&#x27;../&#x27; + comp.name + &#x27;/README.md&#x27;,
    &#x27;# &#x27; + comp.caption + &#x27;\n\n&#x27; +
    mdKeywords(d.join(&#x27;\n&#x27;))
  );

//  grunt.file.write(&#x27;../doc/&#x27; + comp.name.replace(&#x27;/&#x27;, &#x27;.&#x27;) + &#x27;.md&#x27;, comp.description);
};

function doComps(comp, d) {  // {{{2
  if (_.isEmpty(comp.submodules)) return;

  d.push(&#x27;## Components&#x27;);
  d.push(comp.caption + &#x27; consists of the following components:&#x27;);

  for (var key in comp.submodules) {
    var sm = Json.modules[key];
    d.push(&#x27;- &#x27; + sm.caption);
  }

  d.push(&#x27;&#x27;);

  for (var key in comp.submodules) {
    var sm = Json.modules[key];

    d.push(&#x27;### &#x27; + sm.caption);
    d.push(sm.readme);
    d.push(&#x27;&#x27;);
    d.push(&#x27;Read more about [&#x27; + sm.caption + &#x27;] ...\n\n&#x27;);

    doComp(sm);
  }

//  grunt.file.write(&#x27;../doc/&#x27; + sm.name.replace(&#x27;/&#x27;, &#x27;.&#x27;) + &#x27;.md&#x27;, sm.description);
}

function doComp(comp) {  // {{{2
  var d = [comp.readme];
  d.push(&#x27;&#x27;);

  if (comp.description) {
    d.push(comp.description);
    d.push(&#x27;&#x27;);
  }

  doModules(comp, d);

  comp.description = crossKeywords(d.join(&#x27;\n&#x27;));
}

function doModules(comp, d, isMain) {  // {{{2
  d.push(&#x27;## Modules&#x27;);
  d.push(comp.caption + &#x27; consists of the following modules:&#x27;);

  for (var key in comp.classes) {
    var c = Json.classes[key];
    if (isMain &amp;&amp; c.submodule) continue;

    d.push(&#x27;- &#x27; + c.caption);
  }

  d.push(&#x27;&#x27;);

  for (var key in comp.classes) {
    var c = Json.classes[key];
    if (isMain &amp;&amp; c.submodule) continue;

    d.push(&#x27;### &#x27; + c.caption);
    d.push(c.readme);
    d.push(&#x27;&#x27;);
    d.push(&#x27;Module [&#x27; + c.caption + &#x27;] reference ... &#x27;);
    d.push(&#x27;&#x27;);
  }
}

function doModule(name) {  // {{{2
//  console.log(&#x27;DO MODULE&#x27;, name);

  var c = Json.classes[name];

  c.displayName = c.caption;

  var d = [c.readme];
  d.push(&#x27;&#x27;);
  d.push(c.desc);

  c.description = crossKeywords(d.join(&#x27;\n&#x27;));

//  grunt.file.write(&#x27;../doc/&#x27; + c.name.replace(&#x27;/&#x27;, &#x27;.&#x27;) + &#x27;.md&#x27;, c.description);
};

function doModuleItem(name) {  // {{{2
//  console.log(&#x27;DO MODULE ITEM&#x27;, name);

  var c = Json.classitems[name];
  c.description = crossKeywords(c.description);

//  grunt.file.write(&#x27;../doc/&#x27; + c.name.replace(&#x27;/&#x27;, &#x27;.&#x27;) + &#x27;.md&#x27;, c.description);
};

function crossKeywords(text) {  // {{{2
  return linkKeywords(text, crossLink);
};

function mdKeywords(text) {  // {{{2
  return linkKeywords(text, mdLink);
};

function linkKeywords(text, link) {  // {{{2
  if (! text) return &#x27;&#x27;;

  if (typeof text !== &#x27;string&#x27;) {
    console.log(&#x27;NOT A STRING&#x27;, text);
  }

  var prev;
//  console.log(&#x27;CROSSLINK&#x27;, text);

  text = text.split(/([\[\]\(\)])/);
//  text = text.split(/([\[\]])/);

  for (var i = 0; i &lt; text.length; i++) {
    if (text[i] === &#x27;]&#x27;) {
      if ((text[i - 2] !== &#x27;[&#x27;) || (i &lt; 2)) {
        console.log(&#x27;Invalid brackets&#x27;, i, text[i - 2], text[i - 1], text);
        throw new Error(&#x27;aa&#x27;);
        continue;
      }

      var args;
      if (text.length &gt; i + 3) {
        if ((text[i + 2] === &#x27;(&#x27;) &amp;&amp; (text[i + 4] === &#x27;)&#x27;) &amp;&amp; ! text[i + 1].trim()) {
          if (text[i + 3].trim().toLowerCase().match(/^http/)) {
            continue;
          }

          if (text[i + 3].charAt(0) === &#x27;.&#x27;) {
            continue;
          }

          args = text[i + 4];
        }
      }

      text[i - 2] = &#x27;&#x27;;
      text[i - 1] = doLink(text[i - 1]);
      text[i] = &#x27;&#x27;;
//      console.log(&#x27;LINK REPLACED&#x27;, text[i - 1]);
    }
  }

  return text.join(&#x27;&#x27;);

  function doLink(t) {
    if (t === &#x27;constructor&#x27;) {
      k = &#x27;ose.wrap&#x27;;
    } else {
      var k = Keywords[t.toLowerCase().replace(/\s/g, &#x27;&#x27;)];
    }

    if (! k) {
      console.log(&#x27;LINK NOT FOUND&#x27;, t);
      return t;
      return &#x27;[&#x27; + t + &#x27;]&#x27;;
    }

    if (k in Json.modules) {
      return link(t, k, &#x27;module&#x27;);
    }

    if (k in Json.classes) {
      return link(t, k, &#x27;class&#x27;);
    }

    if (k in Json.classitems) {
      return link(t, k, &#x27;classitem&#x27;);
    }

    if (k in Json.files) {
      return link(t, k, &#x27;file&#x27;);
    }

    console.log(&#x27;LINK INVALID&#x27;, t, k);
    return t;
    return &#x27;[&#x27; + t + &#x27;]&#x27;;
  }
}

function mdLink(text, key, type) {  // {{{2
  switch (type) {
  case &#x27;module&#x27;:
    return &#x27;[&#x27; + text + &#x27;](&#x27; + GhUri + &#x27;/modules/&#x27; + key + &#x27;.html)&#x27;;
  case &#x27;class&#x27;:
    return &#x27;[&#x27; + text + &#x27;](&#x27; + GhUri + &#x27;/classes/&#x27; + key + &#x27;.html)&#x27;;
  case &#x27;classitem&#x27;:
    var i = Json.classitems[key];
    return &#x27;[&#x27; + text + &#x27;](&#x27; + GhUri + &#x27;/classes/&#x27; + i.class + &#x27;.html)&#x27;;
  case &#x27;file&#x27;:
    return &#x27;[&#x27; + text + &#x27;](&#x27; + GhUri + &#x27;/files/&#x27; + key + &#x27;.html)&#x27;;
  }

  throw new Error(&#x27;Invalid LINK type: &#x27; + JSON.stringify(arguments));
}

function crossLink(text, key, type) {  // {{{2
//  console.log(&#x27;CROSSLINK&#x27;, text, key, type);

  switch (type) {
  case &#x27;module&#x27;:
    return &#x27;{{#crossLinkModule &quot;&#x27; + key + &#x27;&quot;}}&#x27; + text + &#x27;{{/crossLinkModule}}&#x27;;
  case &#x27;class&#x27;:
    return &#x27;{{#crossLink &quot;&#x27; + key + &#x27;&quot;}}&#x27; + text + &#x27;{{/crossLink}}&#x27;;
  case &#x27;classitem&#x27;:
    var i = Json.classitems[key];
    if (! (i &amp;&amp; i.class &amp;&amp; i.name)) {
      throw new Error(&#x27;MISSING CLASSITEM &#x27; + JSON.stringify(arguments));
    }
    return &#x27;{{#crossLink &quot;&#x27; + i.class + &#x27;/&#x27; + i.name + &#x27;&quot;}}&#x27; + text + &#x27;{{/crossLink}}&#x27;;
  case &#x27;file&#x27;:
    return &#x27;[&#x27; + text + &#x27;](../files/&#x27; + key.replace(/\//g, &#x27;_&#x27;) + &#x27;.html)&#x27;;
  }

  throw new Error(&#x27;Invalid LINK type: &#x27; + JSON.stringify(arguments));
}

function keyword(key, caption, list) {  // {{{2

  if (! (key &amp;&amp; (typeof key === &#x27;string&#x27;))) {
    console.log(&#x27;INVALID KEYWORD&#x27;, arguments);
    return;
  }

  add(key);

  if (caption) {
    add(caption);
  }

  if (! list) return;

  if (typeof list === &#x27;string&#x27;) list = list.split(/\s/);

  for (var i = 0; i &lt; list.length; i++) {
    caption = list[i].trim();
    if (caption) {
      add(caption);
//      Keywords[caption.toLowerCase().replace(/\s/g, &#x27;&#x27;)] = key;
    }
  }

  function add(v) {
    var v = v.toLowerCase().replace(/\s/g, &#x27;&#x27;);
    if (v in Keywords) {
      if (Keywords[v] !== key) {
        console.log(&#x27;DUPLICIT KEYWORD&#x27;, v, key, Keywords[v]);
      }
    } else {
      Keywords[v] = key;
    }
  }
};

function filename(name) {  // {{{2
  var match = name.match(/^\.\.\/(.*)/);

  if (match) {
    name = match[1];

    match = name.match(/^ose\//);
    if (match) {
      return name;
    }

    return &#x27;ose-&#x27; + name;
  } else {
    return &#x27;ose-bundle/&#x27; + name;
  }
};

// }}}1

</pre>

</div>
      </div>

    </div>
  </div>
  <script src="../assets/vendor/prettify/prettify-min.js"></script>
  <script>prettyPrint();</script>
  <script src="../assets/js/yui-prettify.js"></script>
  <!--script src="../assets/js/tabs.js"></script-->
  <script src="../assets/js/ose.js"></script>
</body>
</html>
