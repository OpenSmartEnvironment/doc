<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ose.wrap - ose-bundle</title>
  <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
  <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
  <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
  <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.4/zepto.min.js"></script>
</head>
<body class="yui3-skin-sam">

  <div id="doc">
    <div class="yui3-g">

      <div id="sidebar" class="yui3-u">
        <a href="../index.html"><h2>OSE documentation</h2></a>

        <div class="sidebox">
          <div class="hd">
            <h2 class="no-toc">Type to filter sidebar:</h2>
          </div>
          <div class="bd">
            <input id="filter-input" />
          </div>
        </div>

        







<div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All packages and components</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/bb.html">bb</a>
                
                    <ul>
                        
                            <li><a href="../modules/bb.box.html">bb.box</a></li>
                        
                            <li><a href="../modules/bb.dialog.html">bb.dialog</a></li>
                        
                            <li><a href="../modules/bb.pagelet.html">bb.pagelet</a></li>
                        
                            <li><a href="../modules/bb.widget.html">bb.widget</a></li>
                        
                            <li><a href="../modules/bb.stateObj.html">bb.stateObj</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/boards.html">boards</a>
                
                </li>
            
                <li><a href="../modules/bundle.html">bundle</a>
                
                    <ul>
                        
                            <li><a href="../modules/bundle.lirc.html">bundle.lirc</a></li>
                        
                            <li><a href="../modules/bundle.media.html">bundle.media</a></li>
                        
                            <li><a href="../modules/bundle.rpi.html">bundle.rpi</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/control.html">control</a>
                
                    <ul>
                        
                            <li><a href="../modules/control.distributor.html">control.distributor</a></li>
                        
                            <li><a href="../modules/control.pin.html">control.pin</a></li>
                        
                            <li><a href="../modules/control.room.html">control.room</a></li>
                        
                            <li><a href="../modules/control.remote.html">control.remote</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/dvb.html">dvb</a>
                
                </li>
            
                <li><a href="../modules/fs.html">fs</a>
                
                </li>
            
                <li><a href="../modules/icecast.html">icecast</a>
                
                </li>
            
                <li><a href="../modules/lirc.html">lirc</a>
                
                </li>
            
                <li><a href="../modules/media.html">media</a>
                
                    <ul>
                        
                            <li><a href="../modules/media.history.html">media.history</a></li>
                        
                            <li><a href="../modules/media.player.html">media.player</a></li>
                        
                            <li><a href="../modules/media.stream.html">media.stream</a></li>
                        
                            <li><a href="../modules/media.source.html">media.source</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/ose.html">ose</a>
                
                    <ul>
                        
                            <li><a href="../modules/ose.data.html">ose.data</a></li>
                        
                            <li><a href="../modules/ose.http.html">ose.http</a></li>
                        
                            <li><a href="../modules/ose.peer.html">ose.peer</a></li>
                        
                            <li><a href="../modules/ose.link.html">ose.link</a></li>
                        
                            <li><a href="../modules/ose.logger.html">ose.logger</a></li>
                        
                            <li><a href="../modules/ose.plugin.html">ose.plugin</a></li>
                        
                            <li><a href="../modules/ose.wrap.html">ose.wrap</a></li>
                        
                    </ul>
                
                </li>
            
                <li><a href="../modules/pa.html">pa</a>
                
                </li>
            
                <li><a href="../modules/rpi.html">rpi</a>
                
                </li>
            
                <li><a href="../modules/videolan.html">videolan</a>
                
                </li>
            
                <li><a href="../modules/xorg.html">xorg</a>
                
                </li>
            
                <li><a href="../modules/yoctopuce.html">yoctopuce</a>
                
                </li>
            
                <li><a href="../modules/youtube.html">youtube</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">All modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/bb.content.html">bb.content</a></li>
            
                <li><a href="../classes/bb.lib.html">bb.lib</a></li>
            
                <li><a href="../classes/bb.lib.box.content.html">bb.lib.box.content</a></li>
            
                <li><a href="../classes/bb.lib.box.left.html">bb.lib.box.left</a></li>
            
                <li><a href="../classes/bb.lib.dialog.html">bb.lib.dialog</a></li>
            
                <li><a href="../classes/bb.lib.dialog.action.html">bb.lib.dialog.action</a></li>
            
                <li><a href="../classes/bb.lib.dialog.confirm.html">bb.lib.dialog.confirm</a></li>
            
                <li><a href="../classes/bb.lib.dialog.info.html">bb.lib.dialog.info</a></li>
            
                <li><a href="../classes/bb.lib.dialog.valueSelector.html">bb.lib.dialog.valueSelector</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.html">bb.lib.pagelet</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.dashboard.html">bb.lib.pagelet.dashboard</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.detail.html">bb.lib.pagelet.detail</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.entry.html">bb.lib.pagelet.entry</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.gesture.html">bb.lib.pagelet.gesture</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.list.html">bb.lib.pagelet.list</a></li>
            
                <li><a href="../classes/bb.lib.pagelet.listItem.html">bb.lib.pagelet.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.html">bb.lib.widget</a></li>
            
                <li><a href="../classes/bb.lib.widget.button.html">bb.lib.widget.button</a></li>
            
                <li><a href="../classes/bb.lib.widget.checkbox.html">bb.lib.widget.checkbox</a></li>
            
                <li><a href="../classes/bb.lib.widget.list.html">bb.lib.widget.list</a></li>
            
                <li><a href="../classes/bb.lib.widget.listItem.html">bb.lib.widget.listItem</a></li>
            
                <li><a href="../classes/bb.lib.widget.search.html">bb.lib.widget.search</a></li>
            
                <li><a href="../classes/bb.lib.widget.slider.html">bb.lib.widget.slider</a></li>
            
                <li><a href="../classes/bb.lib.widget.slideswitch.html">bb.lib.widget.slideswitch</a></li>
            
                <li><a href="../classes/bb.lib.widget.toolbar.html">bb.lib.widget.toolbar</a></li>
            
                <li><a href="../classes/boards.content.html">boards.content</a></li>
            
                <li><a href="../classes/boards.lib.html">boards.lib</a></li>
            
                <li><a href="../classes/bundle.doc.html">bundle.doc</a></li>
            
                <li><a href="../classes/bundle.example.lirc.html">bundle.example.lirc</a></li>
            
                <li><a href="../classes/bundle.example.media.html">bundle.example.media</a></li>
            
                <li><a href="../classes/bundle.example.rpi.html">bundle.example.rpi</a></li>
            
                <li><a href="../classes/bundle.examples.lirc.config.html">bundle.examples.lirc.config</a></li>
            
                <li><a href="../classes/bundle.examples.lirc.lirc.html">bundle.examples.lirc.lirc</a></li>
            
                <li><a href="../classes/bundle.examples.media.channels.html">bundle.examples.media.channels</a></li>
            
                <li><a href="../classes/bundle.examples.media.config.html">bundle.examples.media.config</a></li>
            
                <li><a href="../classes/bundle.examples.media.streams.html">bundle.examples.media.streams</a></li>
            
                <li><a href="../classes/bundle.examples.rpi.config.html">bundle.examples.rpi.config</a></li>
            
                <li><a href="../classes/bundle.Gruntfile.html">bundle.Gruntfile</a></li>
            
                <li><a href="../classes/control.content.html">control.content</a></li>
            
                <li><a href="../classes/control.lib.html">control.lib</a></li>
            
                <li><a href="../classes/control.lib.activity.html">control.lib.activity</a></li>
            
                <li><a href="../classes/control.lib.din.html">control.lib.din</a></li>
            
                <li><a href="../classes/control.lib.din.pin.html">control.lib.din.pin</a></li>
            
                <li><a href="../classes/control.lib.distributor.html">control.lib.distributor</a></li>
            
                <li><a href="../classes/control.lib.door.html">control.lib.door</a></li>
            
                <li><a href="../classes/control.lib.door.pin.html">control.lib.door.pin</a></li>
            
                <li><a href="../classes/control.lib.flowMeter.html">control.lib.flowMeter</a></li>
            
                <li><a href="../classes/control.lib.heater.html">control.lib.heater</a></li>
            
                <li><a href="../classes/control.lib.heater.pin.html">control.lib.heater.pin</a></li>
            
                <li><a href="../classes/control.lib.heater.tariff.html">control.lib.heater.tariff</a></li>
            
                <li><a href="../classes/control.lib.light.html">control.lib.light</a></li>
            
                <li><a href="../classes/control.lib.light.pin.html">control.lib.light.pin</a></li>
            
                <li><a href="../classes/control.lib.light.remote.html">control.lib.light.remote</a></li>
            
                <li><a href="../classes/control.lib.light.switch.html">control.lib.light.switch</a></li>
            
                <li><a href="../classes/control.lib.pin.html">control.lib.pin</a></li>
            
                <li><a href="../classes/control.lib.pin.commands.html">control.lib.pin.commands</a></li>
            
                <li><a href="../classes/control.lib.pin.counter.html">control.lib.pin.counter</a></li>
            
                <li><a href="../classes/control.lib.pin.din.html">control.lib.pin.din</a></li>
            
                <li><a href="../classes/control.lib.pin.dout.html">control.lib.pin.dout</a></li>
            
                <li><a href="../classes/control.lib.pin.light.html">control.lib.pin.light</a></li>
            
                <li><a href="../classes/control.lib.pin.list.html">control.lib.pin.list</a></li>
            
                <li><a href="../classes/control.lib.pin.pwm.html">control.lib.pin.pwm</a></li>
            
                <li><a href="../classes/control.lib.pin.switch.html">control.lib.pin.switch</a></li>
            
                <li><a href="../classes/control.lib.remote.html">control.lib.remote</a></li>
            
                <li><a href="../classes/control.lib.room.html">control.lib.room</a></li>
            
                <li><a href="../classes/control.lib.switch.html">control.lib.switch</a></li>
            
                <li><a href="../classes/control.lib.switch.relay.html">control.lib.switch.relay</a></li>
            
                <li><a href="../classes/control.lib.switch.socket.html">control.lib.switch.socket</a></li>
            
                <li><a href="../classes/dvb.content.html">dvb.content</a></li>
            
                <li><a href="../classes/dvb.lib.html">dvb.lib</a></li>
            
                <li><a href="../classes/dvb.lib.channel.html">dvb.lib.channel</a></li>
            
                <li><a href="../classes/fs.content.html">fs.content</a></li>
            
                <li><a href="../classes/fs.lib.html">fs.lib</a></li>
            
                <li><a href="../classes/fs.lib.dir.html">fs.lib.dir</a></li>
            
                <li><a href="../classes/fs.lib.file.html">fs.lib.file</a></li>
            
                <li><a href="../classes/icecast.content.html">icecast.content</a></li>
            
                <li><a href="../classes/icecast.lib.html">icecast.lib</a></li>
            
                <li><a href="../classes/icecast.lib.stream.html">icecast.lib.stream</a></li>
            
                <li><a href="../classes/lirc.content.html">lirc.content</a></li>
            
                <li><a href="../classes/lirc.lib.html">lirc.lib</a></li>
            
                <li><a href="../classes/lirc.lib.lirc.html">lirc.lib.lirc</a></li>
            
                <li><a href="../classes/media.content.html">media.content</a></li>
            
                <li><a href="../classes/media.lib.html">media.lib</a></li>
            
                <li><a href="../classes/media.lib.item.html">media.lib.item</a></li>
            
                <li><a href="../classes/media.lib.player.html">media.lib.player</a></li>
            
                <li><a href="../classes/media.lib.player.commands.html">media.lib.player.commands</a></li>
            
                <li><a href="../classes/media.lib.player.dvb.html">media.lib.player.dvb</a></li>
            
                <li><a href="../classes/media.lib.player.playback.html">media.lib.player.playback</a></li>
            
                <li><a href="../classes/media.lib.player.remote.html">media.lib.player.remote</a></li>
            
                <li><a href="../classes/media.lib.player.volume.html">media.lib.player.volume</a></li>
            
                <li><a href="../classes/media.lib.sources.html">media.lib.sources</a></li>
            
                <li><a href="../classes/media.lib.stream.html">media.lib.stream</a></li>
            
                <li><a href="../classes/ose.content.html">ose.content</a></li>
            
                <li><a href="../classes/ose.core.html">ose.core</a></li>
            
                <li><a href="../classes/ose.lib.browser.html">ose.lib.browser</a></li>
            
                <li><a href="../classes/ose.lib.cli.html">ose.lib.cli</a></li>
            
                <li><a href="../classes/ose.lib.counter.html">ose.lib.counter</a></li>
            
                <li><a href="../classes/ose.lib.entry.html">ose.lib.entry</a></li>
            
                <li><a href="../classes/ose.lib.entry.link.html">ose.lib.entry.link</a></li>
            
                <li><a href="../classes/ose.lib.entry.master.html">ose.lib.entry.master</a></li>
            
                <li><a href="../classes/ose.lib.entry.slave.html">ose.lib.entry.slave</a></li>
            
                <li><a href="../classes/ose.lib.http.html">ose.lib.http</a></li>
            
                <li><a href="../classes/ose.lib.http.content.html">ose.lib.http.content</a></li>
            
                <li><a href="../classes/ose.lib.kind.html">ose.lib.kind</a></li>
            
                <li><a href="../classes/ose.lib.link.html">ose.lib.link</a></li>
            
                <li><a href="../classes/ose.lib.logger.html">ose.lib.logger</a></li>
            
                <li><a href="../classes/ose.lib.node.html">ose.lib.node</a></li>
            
                <li><a href="../classes/ose.lib.peer.here.html">ose.lib.peer.here</a></li>
            
                <li><a href="../classes/ose.lib.peer.list.html">ose.lib.peer.list</a></li>
            
                <li><a href="../classes/ose.lib.peer.remote.html">ose.lib.peer.remote</a></li>
            
                <li><a href="../classes/ose.lib.peer.rx.html">ose.lib.peer.rx</a></li>
            
                <li><a href="../classes/ose.lib.plugins.html">ose.lib.plugins</a></li>
            
                <li><a href="../classes/ose.lib.scope.html">ose.lib.scope</a></li>
            
                <li><a href="../classes/ose.lib.shard.html">ose.lib.shard</a></li>
            
                <li><a href="../classes/ose.lib.shard.master.html">ose.lib.shard.master</a></li>
            
                <li><a href="../classes/ose.lib.shard.slave.html">ose.lib.shard.slave</a></li>
            
                <li><a href="../classes/ose.lib.space.html">ose.lib.space</a></li>
            
                <li><a href="../classes/ose.lib.space.list.html">ose.lib.space.list</a></li>
            
                <li><a href="../classes/ose.lib.ws.html">ose.lib.ws</a></li>
            
                <li><a href="../classes/ose.lib.ws.browser.html">ose.lib.ws.browser</a></li>
            
                <li><a href="../classes/ose.lib.ws.master.html">ose.lib.ws.master</a></li>
            
                <li><a href="../classes/ose.lib.ws.node.html">ose.lib.ws.node</a></li>
            
                <li><a href="../classes/ose.lib.ws.relay.html">ose.lib.ws.relay</a></li>
            
                <li><a href="../classes/ose.lib.ws.slave.html">ose.lib.ws.slave</a></li>
            
                <li><a href="../classes/ose.wrap.class.html">ose.wrap.class</a></li>
            
                <li><a href="../classes/ose.wrap.common.html">ose.wrap.common</a></li>
            
                <li><a href="../classes/ose.wrap.module.html">ose.wrap.module</a></li>
            
                <li><a href="../classes/ose.wrap.package.html">ose.wrap.package</a></li>
            
                <li><a href="../classes/ose.wrap.singleton.html">ose.wrap.singleton</a></li>
            
                <li><a href="../classes/pa.content.html">pa.content</a></li>
            
                <li><a href="../classes/pa.lib.html">pa.lib</a></li>
            
                <li><a href="../classes/pa.lib.dbus.html">pa.lib.dbus</a></li>
            
                <li><a href="../classes/rpi.content.html">rpi.content</a></li>
            
                <li><a href="../classes/rpi.lib.html">rpi.lib</a></li>
            
                <li><a href="../classes/rpi.lib.camera.html">rpi.lib.camera</a></li>
            
                <li><a href="../classes/rpi.lib.rpi.html">rpi.lib.rpi</a></li>
            
                <li><a href="../classes/videolan.content.html">videolan.content</a></li>
            
                <li><a href="../classes/videolan.lib.html">videolan.lib</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.html">videolan.lib.dvblast</a></li>
            
                <li><a href="../classes/videolan.lib.dvblast.master.html">videolan.lib.dvblast.master</a></li>
            
                <li><a href="../classes/videolan.lib.vlc.html">videolan.lib.vlc</a></li>
            
                <li><a href="../classes/xorg.content.html">xorg.content</a></li>
            
                <li><a href="../classes/xorg.lib.html">xorg.lib</a></li>
            
                <li><a href="../classes/xorg.lib.xorg.html">xorg.lib.xorg</a></li>
            
                <li><a href="../classes/yoctopuce.content.html">yoctopuce.content</a></li>
            
                <li><a href="../classes/yoctopuce.lib.html">yoctopuce.lib</a></li>
            
                <li><a href="../classes/yoctopuce.lib.meteo.html">yoctopuce.lib.meteo</a></li>
            
                <li><a href="../classes/youtube.content.html">youtube.content</a></li>
            
                <li><a href="../classes/youtube.lib.html">youtube.lib</a></li>
            
                <li><a href="../classes/youtube.lib.video.html">youtube.lib.video</a></li>
            
        </ul>
    </div>
</div>


      </div>

      <div id="main" class="yui3-u">
        <div class="content"><h1 id="ose.wrap">Classes and singletons</h1>


  <b>Documentation for the "ose.wrap" component</b><br />
  For more details, see "<a href="../modules/ose.html"><strong>ose</strong>" package</a>.


<div><p>This component facilitates the usage of classes or singletons with
simple code sharing and runtime specific behaviour by the browser
and Node.js environments. This makes it possible to use
prototypal inheritance to create classes and singletons and to mix
in modules into class prototypes and singletons.</p>
<h2 id="module-wrapping">Module wrapping</h2>
<p>The creation of classes and singletons is based on the CommonJS
Modules spec. Each class or singleton is defined within its own
module.</p>
<p>To create a class or singleton, you first need to wrap the module
containing the class or singleton definition by calling one of the
following:</p>
<ul>
<li><code>Ose.class(module)</code>.</li>
<li><code>Ose.singleton(module)</code>.</li>
<li><code>Ose.package(module)</code>.</li>
<li><code>Ose.module(module)</code>.</li>
</ul>
<p>Example:</p>
<pre class="code prettyprint"><code>// Module containing class definiton.
&#39;use strict&#39;;

// Require OSE.
var Ose = require(&#39;ose&#39;);
// Create and return wrap instance
var M = Ose.class(module);
...</code></pre>
<p>The <code>Ose</code> variable gives access to global OSE functionalities.  The
<code>M</code> variable contains the module wrapper and gives access to
functionalities relative to the module.</p>
<p>IMPORTANT:</p>
<p>Each time a module is wrapped using <code>Ose.class</code>, <code>Ose.singleton</code> or
<code>Ose.package</code> (ie. not <code>Ose.module</code>), the wrapper adds the <code>M</code>
property to <code>module.exports</code>. It is not allowed to overwrite this
property. The <code>M</code> property is read-only and non-configurable. It is
better not to overload this property.</p>
<h2 id="classes">Classes</h2>
<p>A class is a function used as a class constructor with a prototype.</p>
<p>To use a class, you need to carry out three steps:</p>
<ol>
<li>Prepare a module containing a class definition.</li>
<li>Obtain a class constructor.</li>
<li>Create a new object.</li>
</ol>
<p>First, the class needs to be prepared in the module containing the
class definition by calling <code>Ose.class(module, <a href="../modules/ose.wrap.html">constructor</a>,
<a href="../modules/ose.wrap.html">super</a>)</code>. The <code>constructor</code> is an optional class constructor
method. If it is not defined, it gets created automatically. The
<code>super</code> parameter can be <code>undefined</code>, a class constructor or a
class name. It is not possible to inherit from singletons.</p>
<p>Example module with class preparation::</p>
<pre class="code prettyprint"><code>// Module "ose/lib/entry"
&#39;use strict&#39;;

// Require OSE
var Ose = require(&#39;ose&#39;);

// Wrap module and specifies a class with a constructor
// function <code>C</code> and "EventEmitter" as a super-class.
var M = Ose.class(module, C, &#39;EventEmitter&#39;);

// Class constructor
function C(...) {
  // Call super constructor
  M.super.call(this);
  ...
}

// Add properties of the class&#39; prototype to the <code>exports</code>
// object:

// Define property.
exports.config = function(name, data) {
  ...
};

// Define another property
exports.identify = function() {
  return {
    space: this.shard.space.name,
    shard: this.shard.sid,
    entry: this.id
  };
};</code></pre>
<p>The second step is to obtain a class constructor with its
prototype. This step is carried out when the class is first
accessed by calling <code>M.class(&#39;ose/lib/entry&#39;)</code>. Multiple calls to
<code>M.class(&#39;ose/lib/entry&#39;)</code> return the same, already created
class. When called for the first time, the class prototype is
created from module exports and optional mixins. If the class has
an ancestor, the constructor should usually call the super
constructor (see example above). If a class is defined without a
constructor, the constructor is created.</p>
<p>The last step is to create a new object based on the class.</p>
<p>Class usage example:</p>
<pre class="code prettyprint"><code>// Some other module ...
&#39;use strict&#39;;

// Require OSE
var Ose = require(&#39;ose&#39;);
// Wrap module
var M = Ose.module(module);

// Obtain class constructor (second step).
var Entry = M.class(&#39;ose/lib/entry&#39;);

...

// Create new object as an Entry instance (third step).
entry = new Entry(shard, kind);

...</code></pre>
<p>There is a built-in class named <strong>EventEmitter</strong>. To use this
class, pass <code>&#39;EventEmitter&#39;</code> to the <code>class()</code> method (see the
examples above). In the browser environment, the
<a href="https://github.com/Wolfy87/EventEmitter">"wolfy87-eventemitter"</a>
package is used.</p>
<p>To access the <code>module.exports</code> object that is wrapped and prepared
as a class, call the standard <code>require(&#39;ose/lib/entry&#39;)</code>
method. This call returns the original <code>module.exports</code> object.</p>
<p>To extend any class, use the following example:</p>
<pre class="code prettyprint"><code>// Require OSE
var Ose = require(&#39;ose&#39;);
// Wrap module
var M = Ose.module(module);

// Obtain Entry class
var Entry = M.class(&#39;ose/lib/entry&#39;);

// Add new method to entry class prototype
Entry.prototype.newMethod = function() {...};</code></pre>
<p>Changing the prototype of a class alters all its instances and
descendants, even those already created.</p>
<h2 id="singletons">Singletons</h2>
<p>Each singleton is an object. There are two types of singletons. The
first initializes itself, and the second is initialized outside the
singleton definition.</p>
<p>IMPORTANT: Every singleton must always exist in only one instance
within a single running instance of OSE. The use of npm can result
in mixing multiple installations of packages using singletons
within a single OSE instance. This situation must be avoided.</p>
<p>Like the creation of a class, the creation of a singleton is a
three-step process:</p>
<ol>
<li>Prepare a module containing the singleton&#39;s definition and
create the singleton</li>
<li>Obtain singleton initialization method</li>
<li>Initialize and obtain the singleton</li>
</ol>
<p>Example module with self-initializing singleton::</p>
<pre class="code prettyprint"><code>// Require OSE
var Ose = require(&#39;ose&#39;);
// Wrap module as a singleton
var M = Ose.singleton(module, I, &#39;EventEmitter&#39;);
// Initialization of the singleton
exports = M.init();

// Singleton initialization
function I() {
  // Call super constructor
  M.super.call(this);
  ...
}

// Properties of the singleton are defined in the <code>exports</code> variable:

exports.identify = function() {
  return {
    id: this.id
  };
};

exports.getId = function() {
  return id;
};

...</code></pre>
<p>Example module without singleton self-initialization:</p>
<pre class="code prettyprint"><code>// Require OSE
var Ose = require(&#39;ose&#39;);
// Wrap module as a singleton
var M = Ose.singleton(module, I, &#39;EventEmitter&#39;);
// Initialization of the singleton
exports = M.exports;
...</code></pre>
<p>Example module with separate singleton initialization:</p>
<pre class="code prettyprint"><code>// Some other module ...
&#39;use strict&#39;;

// Require OSE
var Ose = require(&#39;ose&#39;);
// Wrap module
var M = Ose.module(module);

...

// Obtain singleton initialization (second step)
var init = M.singleton(&#39;ose/lib/peer/list&#39;);

// Initialize and obtain singleton (third step)
var result = init(arg);

// Or the second and third step together without the init
// variable:
var result = M.singleton(&#39;ose/lib/peer/list&#39;)(arg);

...</code></pre>
<p>To access or extend any initialized singleton, use standard <code>require</code>:</p>
<pre class="code prettyprint"><code>// Module changing singleton.
&#39;use strict&#39;;

// Require OSE.
var Ose = require(&#39;ose&#39;);

// Obtain singleton.
var result = require(&#39;ose/lib/id&#39;);

// Add new method to the singleton.
result.newMethod = function() {...};</code></pre>
<p>The singleton can be changed before it is initialized. If this is
done, it is possible that the change will be overwritten by mixing
other modules during singleton initialization.</p>
<h2 id="mixins">Mixins</h2>
<p>It is possible to mix another module into a class prototype or
singleton. To do that, use the <code>append()</code> or <code>prepend()</code> methods of
the <code>wrap</code> object.</p>
<p>Example:</p>
<pre class="code prettyprint"><code>// Some module
&#39;use strict&#39;;
// Require OSE
var Ose = require(&#39;ose&#39;);

// Wrap module
var M = Ose.class(module, C, &#39;EventEmitter&#39;);

// Prepend a module
M.prepend(&#39;someModuleName&#39;)
// Append a module depending on the runtime.
M.append(&#39;runtime&#39;)</code></pre>
<p>The <code>append()</code> or <code>prepend()</code> methods supports call chaining. Both
methods accept a module name or array of module names. Properties
to a class prototype or singleton are mixed in the second step of
class or singleton creation. Conflicting properties are overwritten
in the following order: Last prepended, prepended, module.exports,
first appended, appended.</p>
<p>It is possible to use the following predefined values as module names:</p>
<ul>
<li>&#39;browser&#39; – If in the browser environment, use the <code>browser.js</code>
 module from the same directory.</li>
<li>&#39;node&#39; – If in the Node.js environment, use the <code>node.js</code>
 module from the same directory.</li>
<li>&#39;runtime&#39; – Use either the <code>browser.js</code> or <code>node.js</code> module
 depending on the environment.</li>
</ul>
<p>It is possible to use relative paths as module names.</p>
<h2 id="relative-paths">Relative paths</h2>
<p>TODO</p>
<p>A class or singleton is identified by its module
(e.g. <code>ose/lib/entry</code>).</p>
<h2 id="modules">Modules</h2>
<p>Classes and singletons consists of the following modules:</p>
<ul>
<li>Common wrapper class</li>
<li>Class wrapper</li>
<li>Module wrapper</li>
<li>Package wrapper</li>
<li>Singleton wrapper</li>
</ul>
<h3 id="common-wrapper-class">Common wrapper class</h3>
<p>Properties common for all wrappers</p>
<p>Module <a href="../classes/ose.wrap.common.html" class="crosslink">Common wrapper class</a> reference ... </p>
<h3 id="class-wrapper">Class wrapper</h3>
<p>Class defining a class module wrapper.</p>
<p>Module <a href="../classes/ose.wrap.class.html" class="crosslink">Class wrapper</a> reference ... </p>
<h3 id="module-wrapper">Module wrapper</h3>
<p>Class defining a standard module wrapper.</p>
<p>Module <a href="../classes/ose.wrap.module.html" class="crosslink">Module wrapper</a> reference ... </p>
<h3 id="package-wrapper">Package wrapper</h3>
<p>Class defining a package module wrapper.</p>
<p>Module <a href="../classes/ose.wrap.package.html" class="crosslink">Package wrapper</a> reference ... </p>
<h3 id="singleton-wrapper">Singleton wrapper</h3>
<p>The class defining a singleton module wrapper.</p>
<p>Module <a href="../classes/ose.wrap.singleton.html" class="crosslink">Singleton wrapper</a> reference ... </p>
</div>

<br><br>
<span class="foundat">Source file: <a href="../files/.._ose_lib_wrap.js.html#l480"><code>..&#x2F;ose&#x2F;lib&#x2F;wrap.js:480</code></a></span>
</div>
      </div>

    </div>
  </div>
  <script src="../assets/vendor/prettify/prettify-min.js"></script>
  <script>prettyPrint();</script>
  <script src="../assets/js/yui-prettify.js"></script>
  <script src="../assets/js/ose.js"></script>
</body>
</html>
